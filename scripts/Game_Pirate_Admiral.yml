"AssignmentGame_Pirate_Admiral":
  Type: Assignment
  Actions:
    On Assignment:
      - TRIGGER NAME:Proximity TOGGLE:True RADIUS:4
      - execute as_server "npc select <npc.id>"
      - execute as_server "npc lookclose"
    On Unavailable:
      - CHAT "Just a moment, can't you see I'm busy?"
  Interact Scripts:
     - 1 Greeting_pirateAdmiral
'Greeting_pirateAdmiral':
  Type: Interact
  Requirements: 
    Mode: All
  Steps:
    1:
      Chat Trigger:
        1:
            Trigger: /Regex:hi|HI|Hi|hey|Hey|HEY|Hello|hello|HELLO/ there! Who are you?
            Script:
              - ENGAGE
              - IF "<FLAG.G:PirateInProgress || 0>" == "0" FLAG GLOBAL PirateInProgress:0
              - IF "<FLAG.G:PirateInProgress>" == "1" CHAT "Look at those pirates quarrel on those boats. I'm busy watching the spectacle, sorry." ELSE RUNTASK "AdmiralTask"
              - IF "<FLAG.G:PirateInProgress>" == "0" ZAP 2
              - DISENGAGE
    2:
      Chat Trigger:
        1:
            Trigger: Please /Regex:explain|Explain|EXPLAIN/ what's going on here!
            Script:
              - ENGAGE
              - WAIT 1
              - CHAT "It's simple really. These uncouth pirates never stop quarreling! So they hire me to find them ammo and crew."
              - WAIT 2
              - CHAT "If you want to join up, talk to one of the <white>captains<green> down on the dock."
              - WAIT 2
              - CHAT "Once both captains have a large enough crew, I'll open up the <white>cannonball store<green> for a limited time!"
              - WAIT 2
              - CHAT "Once time is up, the crew can use all the cannonballs they've collected to try to <white>sink the enemy's ship<green>!"
              - WAIT 2
              - CHAT "You think you have what it takes to be a top pirate...yarr? Go see one of the <white>captains<green>!"
              - DISENGAGE
              - ZAP 1
        2:
            Trigger: How many people are currently on the /Regex:teams|Teams|TEAMS/?
            Script:
              - ENGAGE
              - IF "<FLAG.G:NumPiratesRed || 0>" == "0" FLAG GLOBAL NumPiratesRed:0
              - IF "<FLAG.G:NumPiratesBlue || 0>" == "0" FLAG GLOBAL NumPiratesBlue:0
              - IF "<FLAG.G:NumPiratesRed>" == "1" CHAT "The <red>Red Raiders<green> have <red>1<green> member." ELSE CHAT "The <red>Red Raiders<green> have <red><FLAG.G:NumPiratesRed><green> members."
              - IF "<FLAG.G:NumPiratesBlue>" == "1" CHAT "The <aqua>Blue Brigands<green> have <aqua>1<green> member." ELSE CHAT "The <aqua>Blue Brigands<green> have <aqua><FLAG.G:NumPiratesBlue><green> members."
              - WAIT 1
              - IF "<FLAG.P:PirateRed || 0>" == "1" CHAT "You are a member of the <red>Red Raiders<green>."
              - IF "<FLAG.P:PirateBlue || 0>" == "1" CHAT "You are a member of the <aqua>Blue Brigands<green>."
              - IF "<FLAG.P:PirateRed || 0>" == "0" && "<FLAG.P:PirateBlue || 0>" == "0" CHAT "You are a member of <white>neither team<green>."
              - DISENGAGE
              - ZAP 1
        3:
            Trigger: I want to /Regex:leave|Leave|LEAVE/ my team!
            Script:
              - ENGAGE
              - IF "<FLAG.P:PirateRed || 0>" == "0" && "<FLAG.P:PirateBlue || 0>" == "0" CHAT "You are not on a team!"
              - IF "<FLAG.P:PirateRed || 0>" == "1" CHAT "You have left the <red>Red Raiders<green>."
              - IF "<FLAG.P:PirateRed || 0>" == "1" FLAG GLOBAL "NumPiratesRed:+:-1"
              - IF "<FLAG.P:PirateRed || 0>" == "1" FLAG PLAYER PirateRed:0
              - IF "<FLAG.P:PirateBlue || 0>" == "1" CHAT "You have left the <aqua>Blue Brigands<green>."
              - IF "<FLAG.P:PirateBlue || 0>" == "1" FLAG GLOBAL "NumPiratesBlue:+:-1"
              - IF "<FLAG.P:PirateBlue || 0>" == "1" FLAG PLAYER PirateBlue:0
              - execute as_server "denizen save"
              - DISENGAGE
              - ZAP 1
        4:
            Trigger: Can you /Regex:teleport|Teleport|TELEPORT/ me home?
            Script:
              - ENGAGE
              - CHAT "Of course."
              - FLAG PLAYER respawn:spawn
              - TELEPORT location:l@<player.flag[respawn]>
              - DISENGAGE
              - ZAP 1
        5:
            Trigger: /Regex:start|Start|START/ the battle!
            Script:
              - ENGAGE
              - WAIT 1
              - CHAT "<red>(NYI)<green>"
              - DISENGAGE
              - ZAP 1
      Proximity Trigger:
        exit:
          Script:
            - ZAP 1
'AdmiralTask':
  Type: Task
  Script:
    - CHAT "Admiral Admiral here! These pirates never get along. I just provide the show! How can I help you?"
    - WAIT 2
    - CHAT "Would you like to..."
    - WAIT 1
    - CHAT "...Have me <gold>explain<green> what's going on?"
    - CHAT "...Check the <gold>teams<green>?"
    - CHAT "...<gold>Leave<green> your team?"
    - CHAT "...Have me <gold>teleport<green> you home?"
    - CHAT "...Or <gold>start<green> the battle?"
    
